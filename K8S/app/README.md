
https://www.programmerall.com/article/63482311767/
Zero, example

#### Структура приложениния                                    
```
   - Namespace                    ./K8S/infra/utils/namespace.yaml
   - ServiceAccount        
   - ClusterRole   
   - ClusterRoleBinding        
   - Role                         ./K8S/security/RBAC.md
   - RoleBinding                  ./K8S/security/RBAC.md
   - ConfigMap        
   - Service    
   - Deployment                   ./K8S/app/deployment.md 
   - Job        
   -      
```
#### Требования 
```

kubernetes общее
     - Используйте imagePullPolicy: IfNotPresent.
     - Масштабирование по горизонтали
    
Конфигурация приложений
	- По возможности, используйте переменные среды окружения.
    - secret выносите в переменные среды окружения или в отдельный конфигурационный файл формата - yaml.

Состояния
    - stateless (kind Deployment)
	- statefull 
	     - храниение во внешней БД или кэш (Redis)
	     - по возможности применяйте podManagementPolicy: Parallel.
	

Логи приложений
    - должны быть в формате json в виде одной строки. Если в сообщении приложения есть переводы строки, они заменяются на ‘\n’.
    - должны выводиться в stdout и stderr.
    - система логирования приложений, кроме стандартного вывода и вывода ошибки, должна иметь возможность параллельно выводить логи в определенный в конфигурации приложения файл или по сети на роутер логов.
    - ротация логов самим приложением. Значение по умолчанию (можно изменять под свою ситуацию):
          - Один файл не более 50Мб;
          - Срок хранения файлов не более 7 дней;
          - Общий размер лог-файлов не более 200M.
    - настройка логирования в конфигурационных параметрах.
    - присваивание ошибкам уникальные номера.
	- хранение логов 
	      - в файл, добавьте в под дополнительный контейнер сборщика логов со своими конфигурационными файлами.
          - по сети само приложение должно уметь отправлять логи по сети.
Метрики
    - использование метрики формата Prometheus.
    - возможность отключения аутентификации для сбора метрик.
    - вынести в конфигурацию путь, по которому можно собирать метрики и выключение аутентификации.

Резервирование ресурсов для приложения
    - определить необходимые для работы приложения ресурсы (CPU и RAM): запросы (requests) и лимиты (limits).
	
Проверка работоспособности приложений.
    - реализация проверки, доступные через отдельный контекст, например /health (путь к контексту должен быть вынесен в конфигурационные параметры):
           - Готовность к запуску (readiness).
           - Работоспособность приложения (liveness).
    - возможность отключения аутентификации при проверках.
    - Информация о запросах к проверкам не должны отражаться в логах приложения. Или отображаться на уровне важности debug. Или должна быть возможность включения/выключения вывода сообщений в логи.

Безопасность
    - возможность работать, не используя учетную запись root
	- В Dockerfile обязательно указывайте пользователя и его UID, с правами которого выполняется приложение.
    - Контейнер в поде должен иметь возможность запускаться от обычных пользователей (не root). Определяйте securityContext — пользователя и группу, с правами которого будет выполняться контейнер.
    - Переменные среды окружения, используемые приложениями, выносите в ConfigMap или Secret.
    - Пароли, токены и прочие конфигурационные параметры, содержащие закрытую информацию, выносите в Secret. Не помещайте их содержимое в git. Создавайте их самостоятельно или при помощи службы поддержки непосредственно в кластере.

Сборка контейнера
	- В теге контейнера в хранилище обязательно указывайте версию приложения:
           - Обычный номер версии должен иметь формат X.Y.Z, где X, Y и Z — неотрицательные целые числа и не должны начинаться с нуля. X — мажорная версия, Y — минорная версия и Z — патч-версия. Каждый элемент должен увеличиваться численно. Например: 1.9.0 ->1.10.0 -> 1.10.1.
           - Предрелизная версия может быть обозначена добавлением дефиса и серией разделённых точкой идентификаторов, следующих сразу за патч-версией. Идентификаторы должны содержать только ASCII буквенно-цифровые символы и дефис [0-9A-Za-z-]. Идентификаторы не должны быть пустыми. Числовые идентификаторы не должны начинаться с нуля. Предрелизные версии имеют более низкий приоритет, чем соответствующая релизная версия. Предрелизная версия указывает на то, что эта версия не стабильна и может не удовлетворять требованиям совместимости, обозначенными соответствующей нормальной версией. Примеры: 1.0.0-alpha, 1.0.0-alpha.1, 1.0.0-0.3.7, 1.0.0-x.7.z.92.
    - Никогда не используйте тэг latest.

Данные контейнера:
	- В случае использования встроенных баз данных (типа SQL Light), больших по объему конфигурационных файлов, файлов изображений и т.д., их нельзя размещать внутри контейнера. Необходимо использовать подключаемые тома. При передаче приложения в эксплуатацию, данные файлы должны быть предоставлены в виде отдельного архива.
    - Тома типа emptyDir занимают место на локальном диске ноды кластера. 	
	

```